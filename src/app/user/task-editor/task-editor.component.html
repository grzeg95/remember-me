<div class="container">
  <div class="col" [formGroup]="taskForm">
    <div class="row">
      <div class="col">
        <div class="form-group">
          <small
            class="form-text text-muted"
            [ngClass]="!taskForm.disabled && (!taskForm.get('description').valid && taskForm.get('description').dirty) ? 'error' : ''"
          >Enter description from 4 to 100 and not only number</small>
          <input formControlName="description" class="border rounded" type="text" name="description" value="" />
        </div>
      </div>
    </div>
    <small
      class="form-text text-center text-muted"
      [ngClass]="!taskForm.disabled && (!taskForm.get('daysOfTheWeek').valid && taskForm.get('daysOfTheWeek').dirty) ? 'error' : ''"
    >Click and select at least one day</small>
    <div class="row">
      <div formGroupName="daysOfTheWeek" class="col offset-md-0 text-center">

        <div *ngFor="let dayOfTheWeek of daysOfTheWeek;" class="form-check">
          <input
            #inputRef
            type="checkbox"
            class="form-check-input d-none"
            [attr.id]="'dayOfTheWeek'+dayOfTheWeek"
            [formControlName]="dayOfTheWeek"
            [checked]="taskForm.get('daysOfTheWeek').get(dayOfTheWeek).value == true"
            >
          <label
            class="form-check-label btn"
            [ngClass]="inputRef.checked ? 'btn-outline-dark shadow' : 'border rounded'"
            [attr.for]="'dayOfTheWeek'+dayOfTheWeek"
          >{{dayOfTheWeek | titlecase}}</label>
        </div>

      </div>
    </div>
    <small
      class="form-text text-center text-muted"
      [ngClass]="!taskForm.disabled && (!taskForm.get('timesOfDay').valid && taskForm.get('timesOfDay').dirty) ? 'error' : ''"
    >Click and select at least one time of day</small>
    <div class="row">
      <div formGroupName="timesOfDay" class="col text-center">

        <div class="form-check">
          <input
            formControlName="duringTheDay"
            #duringTheDay
            class="form-check-input d-none"
            type="checkbox"
            id="timesOfDay-duringTheDay"
            (change)="onDuringTheDayChange()"
          >
          <label
            class="form-check-label btn"
            for="timesOfDay-duringTheDay"
            [ngClass]="duringTheDay.checked ? 'btn-outline-dark shadow' : 'border rounded'"
          >During the day</label>
        </div>

        <div *ngFor="let timesOfDay of timesOfDay;" class="form-check">
          <input
            #inputRef
            type="checkbox"
            class="form-check-input d-none"
            [attr.id]="'timesOfDay'+timesOfDay"
            [formControlName]="timesOfDay"
            [checked]="taskForm.get('timesOfDay').get(timesOfDay).value == true">
          <label
            class="form-check-label btn"
            [ngClass]="[inputRef.checked ? 'btn-outline-dark' : 'border rounded', (inputRef.checked && !duringTheDay.checked) ? 'shadow' : '']"
            [ngStyle]="duringTheDay.checked && {'pointer-events':'none', 'border-color': '#818a92'}"
            [attr.for]="'timesOfDay'+timesOfDay">
            {{timesOfDayDict[timesOfDay]}}</label>
        </div>

      </div>
    </div>
    <hr>
    <div class="row">
      <div class="col text-center">
        <button
          class="btn btn-primary border-primary shadow"
          type="submit"
          [disabled]="taskForm.disabled || !taskForm.dirty || taskForm.invalid || deepEqual(initValues, taskForm.getRawValue())"
          (click)="saveTask()"
        >{{ idIsNull() ? 'Create' : 'Save' }}&nbsp;<i class="fas fa-check-circle"></i>
          <mat-progress-bar *ngIf="savingInProgress" mode="indeterminate"></mat-progress-bar>
        </button>
        <button
          class="btn btn-secondary border rounded-0 shadow"
          type="button"
          (click)="cancelTask()"
        >Close</button>
        <button
          class="btn btn-outline-danger border rounded-0"
          type="button"
          [disabled]="taskForm.disabled || idIsNull()"
          (click)="deleteTask()"
        >Delete<mat-progress-bar *ngIf="deletingInProgress" mode="indeterminate"></mat-progress-bar></button>
      </div>
    </div>
  </div>
</div>
